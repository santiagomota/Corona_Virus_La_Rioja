!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([function(e){e.exports={name:"video-player",version:"1.2.9",description:"",main:"./src/index.js",scripts:{test:"./node_modules/.bin/testem ci --file testem.js --port ${JS_TEST_PORT}",tdd:"./node_modules/.bin/testem dev --file testem.json",report:"./node_modules/.bin/nyc report",start:"./node_modules/.bin/webpack-dev-server --open --config webpack.dev.js",build:"./node_modules/.bin/webpack --optimize-minimize --config webpack.prod.js"},contributors:["Iván Pérez <ivanperez@vocento.com>","Jose Manuel Ortega <jmortega@vocento.com>","Adolfo Sanz Barandiaran <asanz@vocento.com>"],license:"SEE LICENSE IN LICENSE.md",devDependencies:{"@babel/core":"^7.4.3","@babel/plugin-syntax-dynamic-import":"^7.2.0","@babel/preset-env":"^7.4.3","babel-loader":"^8.0.5",chai:"^4.2.0",chromium:"^2.1.0","clean-webpack-plugin":"^2.0.1","copy-webpack-plugin":"^4.6.0","html-webpack-plugin":"^3.2.0","istanbul-instrumenter-loader":"^3.0.1",mocha:"^6.1.3",nyc:"^14.0.0",shelljs:"^0.8.3",testem:"^2.15.1",webpack:"^4.30.0","webpack-cli":"^3.3.0","webpack-dev-server":"^3.3.1","webpack-merge":"^4.2.1","webpack-shell-plugin":"^0.5.0"}}},function(e,t,n){"use strict";n.r(t);var i=n(0),o="vocento.config.multimedia.videoplayer",a=1500,r=document.documentElement.lang&&document.documentElement.lang.split("-").shift()||"es",c="lazy",d=Object.freeze({EMPTY:0,WITH_POSTER:1,WITH_THUMBNAIL:2,WITH_PLAYER:10}),s="voc-video-player-modalcontainer",l="vtm:set",u=Object.freeze({backdrop:!0,keyboard:!0,show:!0}),v={autoplay:!1,controls:!0,loop:!1,modallayer:!1,muted:!1,playsinline:!0,videoad:!0,videolive:!1},p=(Object.freeze({BRIGHTCOVE:"brightcove",YOUTUBE:"youtube",VIMEO:"vimeo",DAILYMOTION:"dailymotion",UNKNOWN:"unknown"}),Object.freeze({anonimo:!0,registrado:!0,trial:!1,suscriptor:!1,periodista:!1})),f=document.location.search.indexOf("debug=1")>-1,h="[VideoPlayer]";function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,c=e[Symbol.iterator]();!(i=(r=c.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(e){o=!0,a=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function y(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var b=function(){function e(t,n){var i=t.source,o=t.accountname,a=t.videoid,r=t.autoplay,c=t.author,d=t.bumperid,s=t.controls,l=t.description,u=t.domain,v=t.edition,p=t.link,f=t.loop,h=t.longdescription,m=t.modallayer,y=t.muted,b=t.name,g=t.newsid,w=t.playerid,j=t.playlistid,T=t.playlistorientation,$=t.playsinline,k=t.poster,P=t.template,O=t.src,E=t.videoad,M=t.videolive;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options={source:i,accountname:o,videoid:a,autoplay:r,author:c,bumperid:d,controls:s,description:l,domain:u,edition:v,link:p,loop:f,longdescription:h,modallayer:m,muted:y,name:b,newsid:g,playerid:w,playlistid:j,playlistorientation:T,playsinline:$,poster:k,template:P,src:O,videoad:E,videolive:M},this.url="".concat(n,"/videos/source/").concat(i,"/account/").concat(o,"/").concat(a,".html")}var t,n,i;return t=e,(n=[{key:"fetch",value:function(){var e=this;return this.promise=Voonto.ready.then(function(){return g.call(e,window.__VOONTO__.getUserType())}).catch(function(){return g.call(e,"anonimo")}),this.promise}}])&&y(t.prototype,n),i&&y(t,i),e}();function g(e){var t=this;return this.options.videoad=this.options.videoad?p[e]:this.options.videoad,Promise.all([Voonto.require("jquery"),Voonto.require("is")]).then(function(e){var n=m(e,2),i=n[0],o=n[1];return t.url+="?".concat(function(e){var t=this,n=[];return Object.keys(this.options).forEach(function(e){(t.options[e]||"boolean"==typeof t.options[e])&&n.push({key:e,value:encodeURIComponent(t.options[e])})}),n.push({key:"isdesktop",value:e.desktop()}),n.push({key:"language",value:"".concat(r)}),n.map(function(e){return"".concat(e.key,"=").concat(e.value)}).join("&")}.call(t,o)),i.ajax(t.url,{dataType:"html"})})}function w(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var j=function(){function e(t,n){var i=t.accountname,o=t.source,a=t.videoid;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata={},this.url="".concat(n,"/videos/source/").concat(o,"/account/").concat(i,"/").concat(a,".json")}var t,n,i;return t=e,(n=[{key:"fetch",value:function(){var e=this;return this.promise?this.promise.then(function(e){return e.video.metadata}):(this.promise=Voonto.require("jquery").then(function(t){return t.ajax(e.url,{dataType:"json"})}),this.promise.then(function(e){return e.video.metadata}))}}])&&w(t.prototype,n),i&&w(t,i),e}();function T(){var e;f&&(e=console).log.apply(e,[h].concat(Array.prototype.slice.call(arguments)))}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P="\n<span>{duration}</span>\n",O=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=t,this.player=n,this.container$=i}var t,n,i;return t=e,(n=[{key:"fetch",value:function(){var e=this;return T("embed.js::fetch"),this.player.fetch().then(function(t){return e.container$.append(t)}).then(function(){return e.container$.append("<style>[data-voc-video-player] .video-player-poster{display: block; position: relative; max-width: 100%; padding-top:56.25%; overflow:hidden;}</style>")}).then(function(){return e.container$.append("<style>[data-voc-video-player] .vjs-big-play-button{display: none !important;}</style>")}).then(function(){return e.container$.append("<style>[data-voc-video-player] .boton-video{pointer-events:none !important}</style>")}).then(function(){return e.container$.append("<style>[data-voc-video-player] .vjs-poster{background-size: cover;}</style>")}).then(function(){return function(){this.container$.children("img").remove(),this.container$.children(".video-player-poster").remove(),this.container$.children().find("img").remove(),this.container$.children().find(".video-player-poster").remove(),this.container$.children().find("iframe").length&&this.container$.children("[data-voc-video-player] > i, [data-voc-video-player] > span, [data-voc-video-player] > .video-player-play-button").remove()}.call(e)}).then(function(){return function(){var e=function(e){if(Number.isNaN(e)||e<0)return null;var t,n,i,o,a;return o=Math.floor(e/1e3),i=Math.floor(o/60),o=(o%=60)<10?"0"+o:o,n=Math.floor(i/60),i=(i%=60)<10?"0"+i:i,t=(t=Math.floor(n/24))<10?"0"+t:t,n=(n%=24)<10?"0"+n:n,a=Math.floor(e%1e3*1e3)/1e3,{days:t,hours:n,minutes:i,seconds:o,milliseconds:a}}(this.metadata.duration);e=0===e.minutes&&0===e.seconds?"directo":e.minutes+":"+e.seconds,Voonto.require("jquery").then(function(t){t("[data-voc-video-player-duration]").each(function(){var n=t(this);n.html(P.replace(/{duration}/g,e))})})}.call(e)})}}])&&k(t.prototype,n),i&&k(t,i),e}();function E(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var M="/AG-|PG-|AT-|EP-|JM-|ACB/g",_="agen",I="videos",V="video",x="php",S=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=t,this.player=n,this.container$=Voonto.$("#".concat(s))}var t,n,i;return t=e,(n=[{key:"fetch",value:function(){var e=this;return T("modal.js::fetch"),this.container$.empty(),function(){$("video").each(function(){var e=$(this).get(0);return e&&!e.paused?e.pause():setTimeout(function(){e&&e.id&&"undefined"!=typeof videojs&&videojs(e.id)&&videojs(e.id).ima3&&videojs(e.id).ima3.adsManager&&videojs(e.id).ima3.adsManager.pause()},0)})}.call(this),Voonto.require("is").then(function(t){return function(e){e.desktop()?this.player.options.autoplay=!0:this.player.options.autoplay=!1}.call(e,t)}).then(function(){return e.player.fetch()}).then(function(t){return e.container$.html(t)}).then(function(){return e.container$.children().first().modal(u)}).then(function(){return function(){var e=this;this.container$.on("hide.bs.modal",function(){return e.container$.empty()})}.call(e)}).then(function(){return function(){this.metadata.link&&this.container$.children().first().find("[data-voc-social-buttons]").socialButtons()}.call(e)}).then(function(){return function(){this.container$.children().first().find("[data-voc-animated-underline]").animatedUnderline()}.call(e)}).then(function(){return function(){var e=this,t="rl";this.metadata.reference_id&&(t=(t=this.metadata.reference_id.substr(0,3)).match(M)?_:t.split("-").shift().toLowerCase());var n=[];if(this.metadata.tags){var i=this.metadata.tags,o=this.metadata.linkurl?this.metadata.linkurl:"";Object.values(i).forEach(function(e){if(-1!==e.indexOf("/main")){var t=e.replace("/main","").split("/");return Object.values(t).forEach(function(e){n.push(e.split("_").pop())}),!1}return-1!==o.indexOf("/"+e+"/")&&(n=e.split("/")),!0})}Voonto.require("moment").then(function(i){Voonto.getInstance().trigger(l,{seccion:I,subseccion1:n[0]?n[0]:"",subseccion2:n[1]?n[1]:"",subseccion3:n[2]?n[2]:"",subseccion4:n[3]?n[3]:"",titular:e.metadata.name,fechaPrimeraPublicacion:i(e.metadata.createdAt).format("YYYYMMDDkkmmss"),fechaModificacion:i(e.metadata.updatedAt).format("YYYYMMDDkkmmss"),tipoContenido:V,sistemaPublicacion:x,firmaAutor:e.metadata.author.name,origenContenido:t})})}.call(e)}).then(function(){Voonto.getInstance().trigger("paywall:content")})}}])&&E(t.prototype,n),i&&E(t,i),e}();function A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Y='\n<img class="'.concat(c,'" data-original="{poster}" width="100%" height="auto" />\n<noscript>\n  <img src="{poster}" width="100%" height="auto" />\n</noscript>\n'),N=function(){function e(t){var n=t.metadata,i=t.player,o=t.container$;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metadata=n,this.player=i,this.container$=o,this.state=d.EMPTY}var t,n,i;return t=e,(n=[{key:"render",value:function(){var e=this;T("view.js::render"),this.container$.on("inview",function(t,n){var i=document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen;if(n){if(T("view.js::render::isInView"),e.state===d.EMPTY)return e.metadata.fetch().then(function(t){e.metadata.metadata=t}).then(function(){return e.container$.attr("data-voc-video-player-processed","true")}).then(function(){return function(){var e=this.player.options.modallayer;this.state===d.EMPTY&&(e?(q.call(this),this.state=d.WITH_POSTER):(function(){this.player.options.modallayer?C.call(this):function(){var e=this;this.container$.off("click"),new O(this.metadata.metadata,this.player,this.container$).fetch().then(function(){setTimeout(function(){return e.container$.find("video").on("playing",function(){e.container$.children("[data-voc-video-player] > i, [data-voc-video-player] > span, [data-voc-video-player] > .video-player-play-button").remove()})},0)}).then(function(){setTimeout(function(){return e.container$.find("video").on("playing",function(){e.container$.children("[data-voc-video-player] > i, [data-voc-video-player] > span, [data-voc-video-player] > .video-player-play-button").remove()})},1e3)}).then(function(){setTimeout(function(){return e.container$.find("video").on("playing",function(){e.container$.children("[data-voc-video-player] > i, [data-voc-video-player] > span, [data-voc-video-player] > .video-player-play-button").remove()})},2e3)})}.call(this)}.call(this),this.state=d.WITH_PLAYER))}.call(e)});var o=e.container$.children().find("video").get(0);setTimeout(function(){!i&&o&&"undefined"!=typeof videojs&&videojs(o.id)&&videojs(o.id).ima3&&videojs(o.id).ima3.adsManager&&videojs(o.id).one("playing",function(){return o.play()})},0)}else{if(T("view.js::render::NOT-isInView"),!(void 0===e.metadata.metadata.renditions.find(function(e){return e.width>0}))){var a=e.container$.children().find("video").get(0);if(a&&!a.paused)return a.pause();setTimeout(function(){a&&"undefined"!=typeof videojs&&videojs(a.id)&&videojs(a.id).ima3&&videojs(a.id).ima3.adsManager&&videojs(a.id).one("playing",function(){return a.pause()})},0)}}return!0})}},{key:"renderPoster",value:function(){var e=this;T("view.js::renderPoster"),this.container$.on("inview",function(t,n){if(n){if(T("view.js::renderPoster::isInView"),e.state===d.EMPTY)return e.metadata.fetch().then(function(t){e.metadata.metadata=t}).then(function(){return e.container$.attr("data-voc-video-poster-processed","true")}).then(function(){return q.call(e)})}else T("view.js::renderPoster::NOT-isInView");return!0})}},{key:"renderThumbnail",value:function(){var e=this;T("view.js::renderThumbnail"),this.container$.on("inview",function(t,n){if(n){if(T("view.js::renderThumbnail::isInView"),e.state===d.EMPTY)return e.metadata.fetch().then(function(t){e.metadata.metadata=t}).then(function(){return e.container$.attr("data-voc-video-thumbnail-processed","true")}).then(function(){return function(){var e=this;this.player.options.poster||(this.player.options.poster=this.metadata.metadata.thumbnail);this.container$.find("img").length&&this.container$.find("img").remove();this.container$.append(Y.replace(/{poster}/g,this.player.options.poster)),setTimeout(function(){return e.container$.find(".".concat(c)).lazyload()},0),this.player.options.modallayer?z.call(this):U.call(this);this.state=d.WITH_THUMBNAIL}.call(e)})}else T("view.js::renderThumbnail::NOT-isInView");return!0})}}])&&A(t.prototype,n),i&&A(t,i),e}();function q(){var e=this;this.player.options.poster||(this.player.options.poster=this.metadata.metadata.poster),this.container$.find("img").length&&this.container$.find("img").remove(),this.container$.append(Y.replace(/{poster}/g,this.player.options.poster)),setTimeout(function(){return e.container$.find(".".concat(c)).lazyload()},0),this.player.options.modallayer?z.call(this):U.call(this),this.state=d.WITH_POSTER}function z(){var e=this;this.container$.on("click",function(){return C.call(e)})}function U(){}function C(){var e=this;this.container$.off("click"),new S(this.metadata.metadata,this.player).fetch().then(function(){setTimeout(function(){return e.container$.on("click",function(){return C.call(e)})},0)})}function H(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(t,"VERSION",function(){return L}),Voonto.ready.then(function(e){var t=e.lookup(o);if(!t.serviceUrl)throw function(){var e;f&&(e=console).error.apply(e,[h].concat(Array.prototype.slice.call(arguments)))}("service url is not defined within ".concat(o)),Error("[VideoPlayer] service url is not defined within ".concat(o));Voonto.require("jquery").then(function(n){n("#".concat(s)).length||n("body").append('<div id="'.concat(s,'"></div>')),R(t),e.on("voonto:reload",function(e,n){R(t,n)}),e.on("videoplayer:refresh",function(e,n){R(t,n)})}),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&(T("index.js::visibilitychange::hidden"),Voonto.require("jquery").then(function(e){e("video").each(function(){var t=e(this).get(0);return!(t&&t.id&&"undefined"!=typeof videojs&&videojs(t.id)&&videojs(t.id).mediainfo&&videojs(t.id).mediainfo.sources)||(!(void 0!==videojs(t.id).mediainfo.sources.find(function(e){return e.width>0}))||(t&&!t.paused?t.pause():setTimeout(function(){t&&t.id&&"undefined"!=typeof videojs&&videojs(t.id)&&videojs(t.id).ima3&&videojs(t.id).ima3.adsManager&&videojs(t.id).ima3.adsManager.pause()},0)))})})),"visible"===document.visibilityState&&T("index.js::visibilitychange::visible")})});var L=i.version;function R(e,t){T("index.js::_init::Version ".concat(L)),Voonto.require("jquery").then(function(n){H(n("[data-voc-video-player]",t)).reduce(function(t,i){return t.then(function(){return new Promise(function(t){!function(e,t,n){T("index.js::_initVideoPlayer");var i=e(n),o={};e.extend(o,v,{source:i.data("voc-video-player-source"),accountname:i.data("voc-video-player-accountname"),videoid:i.data("voc-video-player-videoid"),autoplay:i.data("voc-video-player-autoplay"),author:i.data("voc-video-player-author"),bumperid:i.data("voc-video-player-bumperid"),controls:i.data("voc-video-player-controls"),description:i.data("voc-video-player-description"),domain:i.data("voc-video-player-domain"),edition:i.data("voc-video-player-edition"),link:i.data("voc-video-player-link"),loop:i.data("voc-video-player-loop"),longdescription:i.data("voc-video-player-longdescription"),modallayer:i.data("voc-video-player-modallayer"),muted:i.data("voc-video-player-muted"),name:i.data("voc-video-player-name"),newsid:i.data("voc-video-player-newsid"),playerid:i.data("voc-video-player-playerid"),playlistid:i.data("voc-video-player-playlistid"),playlistorientation:i.data("voc-video-player-playlistorientation"),playlistvideoid:i.data("voc-video-player-playlistvideoid"),playsinline:i.data("voc-video-player-playsinline"),poster:i.data("voc-video-player-poster"),template:i.data("voc-video-player-template"),src:i.data("voc-video-player-src"),videoad:i.data("voc-video-player-videoad"),videolive:i.data("voc-video-player-videolive")});var a=new j(o,t.serviceUrl),r=new b(o,t.serviceUrl);new N({metadata:a,player:r,container$:i}).render()}(n,e,i),setTimeout(t,a)})})},Promise.resolve()),H(n("[data-voc-video-poster]",t)).reduce(function(t,i){return t.then(function(){return new Promise(function(t){!function(e,t,n){T("index.js::_initVideoPoster");var i=e(n),o={};e.extend(o,v,{source:i.data("voc-video-poster-source"),accountname:i.data("voc-video-poster-accountname"),videoid:i.data("voc-video-poster-videoid")});var a=new j(o,t.serviceUrl),r=new b(o,t.serviceUrl);new N({metadata:a,player:r,container$:i}).renderPoster()}(n,e,i),setTimeout(t,0)})})},Promise.resolve()),H(n("[data-voc-video-thumbnail]",t)).reduce(function(t,i){return t.then(function(){return new Promise(function(t){!function(e,t,n){T("index.js::_initVideoThumbnail");var i=e(n),o={};e.extend(o,v,{source:i.data("voc-video-thumbnail-source"),accountname:i.data("voc-video-thumbnail-accountname"),videoid:i.data("voc-video-thumbnail-videoid")});var a=new j(o,t.serviceUrl),r=new b(o,t.serviceUrl);new N({metadata:a,player:r,container$:i}).renderThumbnail()}(n,e,i),setTimeout(t,0)})})},Promise.resolve())})}}]);